2012-11-05 unix-privesc-check trunk

* Add support for PostgreSQL
  * Added postgresql_configuration security check
  * Added postgresql_connection security check
  * Added postgresql_trust security check
  * Added postgresql library
* Added ldap library and ldap_authentication security check
* Added nis library and nis_authentication security check
* Added privileged_arguments security check to verify if textual
  privileged files (like bash scripts) accept arguments from command line
* Added init library and support in privileged library
* Added security check to verify device mount options: dev, suid, user
* Added function file_is_basename to file library
* Renamed devices security check to devices_permission

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-11-02 unix-privesc-check trunk

* Bug fix: uname on Solaris returns SunOS
* Added device library and a security check to verify world-readable and
  world-writable permission on all device files including swap device(s)
* Improved cron library to correctly handle PATH variable from /etc/crontab
  and to differentiate programs lauched by /etc/crontab with
  /etc/cron.[hourly|daily|monthly]
* Added privileged_environment_variables security check to verify if textual
  privileged files (like bash scripts) use environment variables
* Improved privileged_tmp security check to also process textual privileged
  files (like bash scripts)
* Added binary_matches_string_grep function to binary library to avoid
  interpreting the pattern as an extended regular expression

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-11-01 unix-privesc-check trunk

* Bug fix: return value in binary library
* Bug fix: avoid recursing the linker_list_dependencies function
* Added inittab library and support in privileged library
* Improved system_configuration security check to display also sensitive
  directories and their content
* Improved system_configuration security check to notify about writable
  configuration files by non-root users
* More detailed stdout messages for file owner condition across relevant
  security checks
* Updated the shadow library and shadow_hash security check to display a
  warning message when the password hashes file is readable
* Cleaned the code of privileged_dependency check

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-31 unix-privesc-check trunk

* Added cron library to parse /etc/cron*, /var/spool/cron/crontabs/*,
  crontab -l and used it in privileged library
* Enhanced process_show_command function to process /proc/PID/environ and
  return script file path instead of ruby, perl, bash, etc
* Added parse_environ_cwd function to parse /proc/PID/environ file and
  extract the process current working directory
* Added a preliminary check to all functions that call objdump to ensure
  the file is not a textual file (like a bash script, etc)
* Added other file paths to check for permissions in system_configuration
  security check
* Added file_is_directory function to file library

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-30 unix-privesc-check trunk

* Added sudo security check to verify permissions on /etc/sudoers and its
  entries
  * Added functions to parse /etc/sudoers to sudo library

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-28 unix-privesc-check trunk

* Added history_readable security check to list all readable .*_history
  files
* Added homedirs_executable and homedirs_writable security checks
* Added system_configuration security check to list writable permissions on
  system configuration files and directories
* Added support for --verbose switch
* Added passwd_show_homedir function to passwd library
* Aligned test types (symlinks) to all recently developed security checks
* Bug fix: in group_is_in_group_name function

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-22 unix-privesc-check trunk

* Added privileged_nx security check
* Added privileged_relro security check
* Added kernel library
* Added system_aslr security check
* Added system_mmap security check
* Added system_nx security check
* Added system_selinux security check
* Added permission_is_world_writable_sticky_bit function to permission
  library
* Added support to verify sticky bit against world-writable directories
* Renamed banned_* security checks to privileged_*

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-22 unix-privesc-check trunk

* Added lib/misc/validation and modified lib/misc/* to use it.
  The aim is to sanity check that libraries are being called
  correctly.  We can improve this over time
* Bug fix: Renamed validation_is_regex to validation_matches_regex
  in lib/misc/validation
* Bug fix: validation_matches_regex test was wrong, should be -n
  not -r in lib/misc/validation
* Bug fix: Added inclusion checks to prevent multiple inclusions
* Bug fix: Changed lib/misc/* to catch data returned by
  validate_is_*
* Removed unnecessary calls to file_check_or_generate_cache in
  lib/misc/checks/*
* Updated symlinks for different types of scan
* Removed tools/banned.h
* Tidied up formatting
* Fixed AIX specific bug with checking users don't have a password
  of ! in lib/checks/passwd_hashes

-- Tim Brown <timb@nth-dimension.org.uk>

2012-10-21 unix-privesc-check trunk

* Added library to parse patterns, for now implements only one function to
  extract and return all absolute file paths, parse_extract_absolute_filepaths
* Added sudo library
* Added sudo support to privileged library
* Added user library
* Added group library
* Added permission library
* Added file_is_readable function to file library
* Added two functions to file library: file_exists_file and
  file_is_regular_file and 
* Added validate_is_boolean function to validate library
* Added support for --color switch to enable output coloring
* Updated jar and key_material security checks: removed one cycle, minor
  refactoring and use new user and group libraries
* Ported all calls to id command throught the code to their relevant
  user/group libraries functions
* Bug fix: missing import bug in binary_rpath security check

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-21 unix-privesc-check trunk

* Bug fix: Changed $VERSION to ${VERSION} etc in upc.sh
* Removed old TODOs from lib/checks/set[ug]id
* Bug fix: Removed symlink exclusion in lib/misc/file cache
  generation

-- Tim Brown <timb@nth-dimension.org.uk>

2012-10-20 unix-privesc-check trunk

* Minor improvements to lib/misc/linker
* Bug fix: avoid using file as variable name
* Bug fix: use grep instead of egrep in one file function
* Consolidated the stdout to clarify where the warning message throughout
  binary_* checks
* Improved key_material and jar checks to show more detailed stdout
* Major speedup to group_writable and world_writable checks
* Re-engineered binary_dependency check
* Improved binary_rpath and binary_writable security checks to also verify
  write access by non-root users
* Refactored system_libraries check code
* Added function to check for SSH key files permissions to ssh_agent
  security check
* Renamed ssh_key_unencrypted check to ssh_key
* Consolidated ssh_agent and ssh_key checks to also show encrypted key files
* Removed exclusions from credentials security check
* Created file function file_is_textual
* Improved file_show_symlinked_filename function to be recursive and always
  return the real linked filename

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-19 unix-privesc-check trunk

* Re-engineered check lib/checks/binary_rpath
* Fixed the file_parent_traverse function call in lib/checks/binary_writable
  and lib/checks/system_libraries
* Fixed some more checks' descriptions
* Bug fix: Syntax fix in lib/misc/binary

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-18 unix-privesc-check trunk

* Tidied up upc.sh, added an additional error check
* Purged dummy, replaced with _ after suggestion from BDA
* Bug fix: No longer considers "enabled" as a check
* Changed lib/misc/privileged to split out cache generation so that it
  happens on inclusion
* Bug fix: Removed unintentional trailing space from file cache

-- Tim Brown <timb@nth-dimension.org.uk>

2012-10-18 unix-privesc-check trunk

* Bug fix: Fixed regexp patterns to avoid returning directories in
  lib/misc/privileged and lib/misc/file

-- <pentestmonkey@pentestmonkey.net>

2012-10-18 unix-privesc-check trunk

* Added check lib/checks/binary_writable
* Bug fix: Proper use of dirname in file_show_symlinked_filename function
* Bug fix: Replaced STDIN redirection with cat for inetd configuration
  files parsing in lib/misc/linker
* Bug fix: Avoid escaping a path with an asterisk in lib/misc/ssh_agent
* Refactored check lib/checks/system_libraries code
* Refactored check lib/checks/world_writable code
* Refactored check lib/checks/binary_dependency code
* Refactored checks lib/checks/setuid and lib/checks/setgid code
* Improved a lot speed of lib/checks/jar and lib/checks/key_material
* Improved lib/misc/ssh_agent to work on recent Linux distributions too
  and inspect /tmp folder for both SSH agent parent process and pid-1
* Avoid duplicate processes entries in lib/misc/privileged
* Improved regular expression patterns throughout the code
* Added --check and --version switches to upc.sh
* Added description to missing checks
* Added verbose comment to lib/checks/ssh_key_unencrypted with suggestions
  for improvements
* Set subversion properties on all missing files

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-10-18 unix-privesc-check trunk

* Changed lib/misc/shadow to favour 1 egrep over 2 greps

-- Tim Brown <timb@nth-dimension.org.uk>

2012-10-17 unix-privesc-check trunk

* Added lib/checks/binary_path
* Added lib/checks/binary_random
* Changed stdio_message_error to output to STDERR
  in lib/misc/stdio
* Removed date from output (reverting BDA change)
* Updated lib/misc/ssh_agent
* Updated lib/misc/shadow
* Updated lib/misc/process (reverting BDA change)
* Updated lib/misc/privileged (partially reverting BDA change)
  * Kept the caching code
  * Kept variable name changed to make the code more readable
* Updated lib/misc/passwd
* Updated lib/misc/linker (reverting BDA change)
* Updated lib/misc/inetd (reverting BDA change)
* Updated lib/misc/dependencies to disable for now.  The
  principal is solid, but it needs more consideration.  
  For example, why does only lib/misc/binary need dependencies,
  what happens on non-Linux systems etc
* Added docs/HACKING.  I will need to work on it but it should
  help to smooth the path for new hackers :)
* Updated lib/misc/file (partially reverting BDA change)
  * Kept symlink related code
  * Kept permissions related code
* Changed lib/misc/privileged to use file_list_by_perms
  correctly.  Bonus, reduction of loops

-- Tim Brown <timb@nth-dimension.org.uk>

2012-10-17 unix-privesc-check trunk

* Added binary_banned_api function to lib/misc/binary
* Added file_show_symlinked_file function to lib/misc/file
* Added code comments to lib/misc/file
* Added cashing mechanism to lib/misc/privileged
* Added file headers throughout the source code
* Added checks' description in comment headers
* Added date to standard output function
* Added an error message log function
* Added notification of needed dependencies (binutils package)
* Narrowed down regular expression patterns in some checks
* Refactored check lib/checks/credentials code and exclude man pages and
  python/ruby/perl libraries
* Refactored check lib/checks/binary_dependency code
* Refactored check lib/checks/group_writable code
* Removed unnecessary Linux-specific code from lib/misc/process
* Standardized checks' standard output and removed unnecessary lines

-- Bernardo Damele A. G. <bernardo.damele@gmail.com>

2012-09-23 unix-privesc-check trunk

* Bug fix: Changed from stdio_message_debug to stdio_message_warn
  in lib/checks/binary_banned
* Bug fix: Incorrect symlink checking in binary_dependency,
  binary_rpath, world_writable and group_writable
* Added support for PIE to lib/misc/binary
* Added lib/checks/binary_pie
  
-- Tim Brown <timb@nth-dimension.org.uk>

2012-09-22 unix-privesc-check trunk

* Started adding --help
* Removed date from output
* Bug fix: Changed $1 to ${1} etc
* Added message when generating cache
* Bug fix: Checking wrong variable in lib/misc/process
* Added lib/misc/privileged
* Changed string checks from "" to -n etc
* Standardised variable names
* Changed how checks are enabled, it is now possible to have
  different types of scan using --type
* Added check for encryption to lib/checks/ssh_key_unencrypted
* Renamed lib/checks/binary_changeprivs to
  lib/checks/binary_change_privileges
* Updated docs/COPYING.UNIX-PRIVESC-CHECK to reference
  version 1 explicitly.  This will allow version 2 into
  Debian and other free distributions
* Added lib/checks/binary_banned
* Added check for lack of XXX in lib/checks/tmp
* Added check for DT_RUNPATH to lib/checks/binary_rpath
* Started work on porting lib/misc/* to Solaris

-- Tim Brown <timb@nth-dimension.org.uk>

2012-09-11 unix-privesc-check trunk

* Branching 1.x at revision 26
* 2.0 released
* Bug fix: Typo in lib/checks/binary_dependency
* Improved output of lib/checks/system_libraries,
  lib/checks/binary_dependency, lib/checks/binary_rpath

-- Tim Brown <timb@nth-dimension.org.uk>

2010-12-30 unix-privesc-check trunk

* Bug fix: Cleaned up a typo
* Added support for fscaps
* Updated CHANGELOG

-- Tim Brown <timb@nth-dimension.org.uk>

2010-11-09 unix-privesc-check trunk

* Bug fix: False positive if svn.simple directory is empty

-- <pentestmonkey@pentestmonkey.net>

2010-11-04 unix-privesc-check trunk

* Added unique issue numbers. Should help to generate reports

-- <pentestmonkey@pentestmonkey.net>

2010-04-17 unix-privesc-check trunk

* Bug fix: Now checks HP-UX swap permissions correctly
* Bug fix: Cleaned up a few typos

-- Tim Brown <timb@nth-dimension.org.uk>

2010-09-27 unix-privesc-check trunk

* Added check for cleartext subversion passwords in home directory

-- <pentestmonkey@pentestmonkey.net>

2010-01-06 unix-privesc-check trunk

* Added support for exploit mitigations (HP-UX and Solaris)
* Checks if shadow and passwd are writable, thanks jdv
* Checks for SetUID shell scripts which might be racey
* Improved NX and SSP checks (Linux only)
* Bug fix: Cleaned up a few typos

-- Tim Brown <timb@nth-dimension.org.uk>

2009-09-23 unix-privesc-check trunk

* Bug fix: Cron jobs starting with '(' parsed properly
* Checks perms on Java classpath

-- <pentestmonkey@pentestmonkey.net>

2009-09-06 unix-privesc-check trunk

* Added MMAP allows map to 0 exploit mitigation (Linux ATM)
* Added SELinux exploit mitigation (Linux only)

-- Tim Brown <timb@nth-dimension.org.uk>

2009-07-30 unix-privesc-check v1.5

* Initial AIX support added
* Check for exploit mitigations (Linux only ATM)
* Brain dumped some more interesting things to check for into TODOs
* Bug fix: Fixed typos in comments
* Added SSP exploit mitigation (Linux only ATM)

-- Tim Brown <timb@nth-dimension.org.uk>

2008-11-23 unix-privesc-check v1.4

* Added check of file perms of shared libraries used by SUID programs
* Tidied output slightly

2008-11-09 unix-privesc-check v1.3

* Bug fix: Parts of the script only worked with /bin/bash and not /bin/sh
* Bug fix: Fixed typos in reporting for privescs via cron

2008-07-06 unix-privesc-check v1.2

* Added check of library dirs (/etc/ld.so.conf) for Linux
* Crude check of programs called from shell scripts
* Check of libraries used by each binary program (using ldd)
* Check of hard-coded paths within binaries (using strings)
* More verbose WARNING messages.  All the explanation for a WARNING
  should now be on one line so you can grep for 'WARNING' and still
  understand the results
* Check of file perms on open file handles of running processes
* Check for running SSH agent.  Lists keys if possible
* Check for public and private SSH keys in home directories
* Check for running GPG agent
* Check for cron jobs in /var/spool/cron/tabs
* Extra non-priv check for local postgres trusts
* Bug fix: lanscan now used on HPUX to get interface names
* Check if system is an NFS client (HPUX only)
* Check if swap space is readable / writable

2008-04-17 unix-privesc-check v1.1

* Added check for accounts with no password in /etc/passwd
* Record some basic info about the host (hostname, uname -a, interface IPs)

2008-02-01 unix-privesc-check v1.0

* Initial public release
